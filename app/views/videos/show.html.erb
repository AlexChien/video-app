<!-- 展示页面 视频详细信息显示 开始 -->

<%= javascript_include_tag 'flowplayer' %>

<div class = "video_show">
  
	<h1><%= @video.title %></h1>
	
  <% if current_user && current_user.has_role?('admin') %>
    <%= link_to "管理该视频", edit_admin_video_path(@video) %>  <br />
  <% end %>	
	
	<div class = "author">Uploaded By: <%= link_to @video.user.login, @video.user %> on <%= @video.created_at %></div>
	<span class = "tags">Tagged with: <span><%= @video.tag_list %></span></span>
		<% if @video.state == "converted" %>
			<p id = "video">
				<a  
					 href="<%= @video.asset.url(:transcoded) %>"  
           style="display:block;width:500px;height:375px" 
					 id="player"> 
				</a> 
			  
				<!-- this will install flowplayer inside previous A- tag. -->
				<script>
					flowplayer("player", "/flowplayer/flowplayer-3.0.3.swf",{clip:{autoPlay: false, autoBuffering: false}});
				</script>
			</p>
  <% else %>
    <% if @video.state == "error" %>
      <h2>视频编码错误，请联系管理员</h2>	
    <% elsif @video.state == "pending" %>
      <h2>视频尚未审核通过</h2>
    <% else %>
      <h2>视频正在编码中，稍后再试</h2> 	
    <% end %>
  <% end %>
		<br />
	<p><%= @video.description %></p>

<% if false %>
<br/><%=  @video.asset.url %>
<br/><%=  @video.asset.url(:small) %>
<br/><%=  @video.asset.url(:medium) %>
<br/><%=  @video.asset.url(:large) %>
<br/><%=  @video.asset.path %>
<br/><%=  @video.asset.path(:small) %>
<br/><%=  @video.asset.path(:medium) %>
<br/><%=  @video.asset.path(:large) %>
<% end %>

  <%#= image_tag @video.asset.url %>
  <%#= image_tag @video.asset.url(:large) %>


	<div id = "video_replies">
		<%= render :partial => 'reply' %>
		
		<% for reply in @video.replies do %>
			<div class = "reply">
				<p class = "author">Posted By: <%= link_to reply.user.login, reply.user %> on <%= reply.created_at %></p>
				<%= reply.body %>
			</div>
		<% end %>
	</div>

</div><!-- /video_show -->		

<!-- 展示页面 视频详细信息显示 结束 -->	